{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <ul class="flashes">
    {% for category, message in messages %}
      <li class="{{ category }}">{{ message }}</li>
    {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>报销自用 - 首页</title>
    <script>
        // 根据URL路径动态设置页面标题
        window.addEventListener('load', function() {
            const path = window.location.pathname;
            let pageDescription = '首页';
            
            if (path.includes('/add_project')) {
                pageDescription = '输入项目';
            } else if (path.includes('/add_expense')) {
                pageDescription = '输入支出';
            } else if (path.includes('/stats')) {
                pageDescription = '查看统计';
            } else if (path.includes('/edit_expense')) {
                pageDescription = '编辑支出';
            } else if (path.includes('/edit_project')) {
                pageDescription = '编辑项目';
            } else if (path.includes('/orphan_expenses')) {
                pageDescription = '孤立支出';
            } else if (path.includes('/import_expense')) {
                pageDescription = '导入支出';
            } else if (path.includes('/change_password')) {
                pageDescription = '修改密码';
            } else if (path.includes('/expenses/')) {
                pageDescription = '支出明细';
            } else if (path.includes('/category_stats')) {
                pageDescription = '费用分类统计';
            } else if (path.includes('/category/')) {
                pageDescription = '分类明细';
            }
            
            // 直接设置整个标题
            document.title = '报销自用 - ' + pageDescription;
        });
    </script>
    <link href="https://unpkg.com/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/style.css" rel="stylesheet">
    <script src="https://unpkg.com/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://unpkg.com/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">报销自用</a>
    
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <div class="navbar-nav">
                    <a class="nav-link" href="/add_expense">记录支出</a>
                    <a class="nav-link" href="/stats">项目统计</a>
                    <a class="nav-link" href="/category_stats">费用分类</a>
                </div>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        {% block content %}{% endblock %}
    </div>
</body>
</html>